# 旋光仪控制软件 v1.5.5 操作说明

## 欢迎

欢迎使用旋光仪控制软件 v1.5.5。请遵循顶部标签页的引导，按以下顺序完成实验：

1.  **设备**：连接并检查旋光仪电机与相机硬件。
2.  **模型**：(首次使用或更换环境时) 录制视频并训练用于识别旋光状态的 AI 模型，并进行零点校准。
3.  **静态与动态测量**：填入实验参数，开始自动化的数据采集流程。
4.  **数据处理**：导入实验数据，进行动力学拟合与分析。

祝实验顺利！

---

## 软件主界面

顶部是**主功能标签栏**，左侧是**主工作区**，右侧是固定的**监视面板**。

### 监视面板（右侧）

监视面板始终显示，提供关键信息和常用控制。

* **准备清单**：实时显示 串口电机、相机 和 识别模型 的连接与就绪状态。
* **实时画面**：显示相机捕捉到的三分视场画面。
  * **交互**：
    * **缩放**：鼠标滚轮向上或向下滚动，可以放大或缩小画面。
    * **平移**：按住鼠标左键拖动，可以平移画面。
* **曝光与识别设定**：
  * **曝光设定**：调整相机曝光值（默认-8.0），确保视场清晰、曝光适宜。
  * **锁定圆形位置**：勾选后可固定识别区域，该区域在录制和测量时通用。可随时勾选/取消，以调整和优化锁定的视场位置，建议在全明或暗明暗时。
  * **尺寸范围**：设定识别算法检测的最小和最大圆半径。
* **日志**：显示软件运行的后台日志信息，时刻关注以获取当前任务信息及报错。

---

## 一、设备

此标签页用于连接和管理硬件设备。

1.  **启动硬件与软件**：
    * 打开旋光仪主机开关（启动光源），接通电机控制盒电源。
    * 使用 USB 线连接电脑，然后运行本软件。
2.  **连接设备**：
    * **串口电机连接**：
      * 软件通常会自动连接。如连接失败，请在下拉框中选择正确的串口号，然后点击 **【连接】**。
      * 可点击 **【刷新】** 更新可用串口列表。
      * 连接成功后，可点击 **【测试】** 按钮以验证连接，结果将会在日志输出。
    * **相机连接**：
      * 在下拉框中选择正确的相机设备（通常带“1080P”字样），然后点击 **【连接】**。
      * 连接成功后，右侧监视面板应出现实时画面。
3.  **设定电机参数**：
    * **正值对应**：根据您的旋光仪特性，选择正旋光度对应的视场类型是“暗明暗(AMA)”还是“明暗明(MAM)”，维持默认值即可。

---

## 二、模型

此标签页用于采集训练数据、训练AI识别模型以及校准仪器零点。

### 1. 视频录制

* **说明**：视频用于机器学习模型训练，以区分“明暗明”和“暗明暗”两种状态。请确保录制时旋光管内已注满去离子水（无气泡），且视场清晰、曝光适宜。
* **步骤**：
  1.  在 **【视频录制】** 区域，使用 **【手动旋转】** 功能，将视场调整到接近均匀暗场的“明暗明”状态。
  2.  在下拉框中选择 **【明暗明 (MAM)】** 模式。
  3.  设置一个 **【每次录制旋转】** 的角度（建议 15° 以内）。
  4.  点击 **【开始录制】**，选择一个文件夹用于存放所有录制数据（若选择的文件夹为 data 则 MAM 将储存到 data/dataset0 中，AMA 将储存到  data/dataset1）。录制开始后，电机同时旋转设定的角度并回转后录制自动结束。
  5.  同样地，手动旋转至接近均匀暗场的“暗明暗”状态，在下拉框选择 **【暗明暗 (AMA)】** 模式，重复上述步骤录制AMA视频。

### 2. 模型训练

1.  **加载数据集**：
    * **录制数据集**：点击 **【...】** 按钮，选择刚才录制视频时创建的文件夹。软件会自动处理其中的MAM和AMA视频，生成数据集。
    * **常驻数据集**：(可选但建议) 点击 **【...】** 按钮，选择软件附带的基础数据集文件夹。这包含了大量数据，可以显著提高模型准确率。
2.  **开始训练**：
    * 点击 **【训练模型】**。训练完成后，界面下方会显示 **混淆矩阵** 和 **整体准确度**。
    * 若准确率低于99.0%，建议检查录制视频的质量或仅使用常驻数据集进行训练。

### 3. 自动零点校准

* **前提**：必须确保 **模型已就绪**、**相机已连接**、**串口已连接**。
* **操作**：
  1.  确保旋光管内为去离子水。
  2.  点击 **【寻找旋光零点】**。
  3.  软件将自动控制电机旋转，并利用模型寻找最接近“均匀暗场”的零点位置。
  4.  完成后，日志提示零点已找到，此时“电机状态”会显示 **当前角度：0.00°**。

---

## 三、静态测量

此标签页用于测量样品的静态旋光度。

1.  **准备样品**：
    * 取出旋光管，装满待测溶液（无气泡），放回旋光仪镜筒中。
    * 如有必要，在右侧监视面板调整 **【锁定圆形位置】**。

2.  **手动控制 (可选)**：
    * 如果您知道样品的大致旋光度，可以在 **【手动旋转至】** 输入框中填入一个角度，点击 **【旋转】**，快速到达目标位置附近。

3.  **开始测量**：
    * 在 **【静态测量设置】** 区域，设置测量次数（1-10次）。
    * 点击 **【运行精细测量】**。
    * 软件将自动进行精密测量并寻找旋光角。测量结果会实时显示在下方的表格中。

4.  **结果处理**：
    * 点击 **【保存结果】** 可将表格中的数据导出为 .xlsx 文件。
    * 点击 **【清除结果】** 可清空当前测量数据，若不清除结果，每次运行测量追加在原结果之上。

---

## 四、动态测量

此标签页用于跟踪化学反应过程中的旋光度变化。

1.  **参数设置**：
    * 在 **【动态测量设置】** 区域，填写本次实验的参数，如温度、浓度、步进角度和采样点数。
    * **步进角度**：负值用于监测旋光度递减的反应（一般为 -0.5°），正值用于监测递增的反应。

2.  **测量过程**：
    1.  **准备反应**：准备好反应溶液。
    2.  **手动旋转**（可选但建议）：若反应初始旋光度较大，可以先手动旋转**至**一个接近零点的位置。
    3.  **开始计时**：当反应物混合时（例如混合到一半时），立即点击 **【开始计时】**。此时您需要选择一个 .xlsx 文件路径用于自动保存本次实验的数据。注意，计时将在你**成功提交**路径名（你需要先解决路径选择、命名和文件名重复等问题）之后立刻开始。
    4.  反应液快速装入旋光管中，放回仪器，迅速调整好视场后，点击 **【开始跟踪】**。
    5.  系统将自动进行测量，实时跟踪反应过程，并在下方的表格中显示数据点。
    6.  当达到设定的**采样点数目**后，测量会自动停止，数据会自动保存到您之前选定的文件中，并且电机将自动复位到零点。
    7.  在测量过程中可以随时更改**采样点数目**和**步进角度**。
    8.  点击 **【停止跟踪】** 不会停止计时，机器会自动回到零点可以重新开始跟踪。
    9.  点击 **【停止计时】** 也会停止跟踪，而且会停止计时，这一次反应溶液将无法再次被测量。

---

## 五、数据处理

此标签页用于对动态测量得到的数据进行动力学分析和线性回归。

1.  **加载数据**：点击 **【加载数据】**，选择一个由动态测量保存的 .xlsx 文件。
2.  **设置参数**：
    * **α∞**：输入反应终点的旋光度 α∞ 值。
    * **拟合模式**：根据反应级数，选择不同的回归模型。
    * 若产生与对数或倒数有关的不合法数据会以红色注明。
3.  **查看结果**：
    * 左侧表格会显示处理后的数据。
    * 右侧绘图区会显示 **数据散点图** 和 **线性回归拟合直线**。
    * 图表下方会显示 **回归方程** 和相关系数。

---

## 其他功能

* **文档**：点击主界面顶部最右侧的 **【文档】** 按钮，可以打开你正在看的这个窗口。

## 结束操作

1.  关闭旋光仪主机和电机控制盒电源。
2.  关闭本软件。
3.  拔下USB线。
4.  取下旋光管，润洗干净并灌上去离子水，妥善放置。

## 注意事项

* 开启电机控制盒电源后仅允许软件控制转动，**禁止外力手动旋转**。
* 测量时需确保样品管中无气泡，并已达到恒温条件。
* 测量结束后及时清洗旋光管，防止残留物污染光路。